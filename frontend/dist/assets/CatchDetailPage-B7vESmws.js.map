{"version":3,"file":"CatchDetailPage-B7vESmws.js","sources":["../../src/pages/CatchDetailPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { catchById, addCatchComment } from '../api';\nimport Icon from '../components/Icon';\nimport config from '../config';\n\nconst CatchDetailPage: React.FC = () => {\n  const { id } = useParams();\n  const [data, setData] = useState<any>(null);\n  const [err, setErr] = useState('');\n  const [text, setText] = useState('');\n\n  useEffect(()=>{\n    if (!id) return;\n    catchById(id).then(setData).catch((e)=> setErr(e.message||'Ошибка'));\n  },[id]);\n\n  async function submitComment(e:React.FormEvent){\n    e.preventDefault();\n    try{\n      await addCatchComment(String(id), text);\n      setText('');\n      // простая перезагрузка данных\n      const d = await catchById(String(id));\n      setData(d);\n    }catch(ex:any){\n      alert(ex?.message||'Не удалось добавить комментарий');\n    }\n  }\n\n  if (err) return <div className=\"container\"><div className=\"card glass\" style={{color:'#ffb4b4'}}>{err}</div></div>;\n  if (!data) return <div className=\"container\"><div className=\"card glass\">Загрузка…</div></div>;\n\n  return (\n    <div className=\"container\">\n      <h2 className=\"h2\">Улов #{id}</h2>\n      {data.photo_url && <img src={data.photo_url} alt=\"\" style={{width:'100%', borderRadius:12}} />}\n      {data.caption && <div style={{marginTop:8}}>{data.caption}</div>}\n\n      <div className=\"row\" style={{gap:8, marginTop:10}}>\n        <button className=\"btn\"><Icon name={config.icons.like} /> {data.likes_count ?? 0}</button>\n        <button className=\"btn\"><Icon name={config.icons.share} /> Поделиться</button>\n      </div>\n\n      <h3 style={{marginTop:16}}>Комментарии</h3>\n      <div className=\"grid\">\n        {(data.comments || []).map((c:any, i:number)=>(\n          <div key={i} className=\"card glass\">\n            <div className=\"row\" style={{justifyContent:'space-between'}}>\n              <strong>{c.user_name || 'гость'}</strong>\n              <span className=\"muted\">{new Date(c.created_at||Date.now()).toLocaleString()}</span>\n            </div>\n            <div style={{marginTop:6}}>{c.text}</div>\n          </div>\n        ))}\n      </div>\n\n      <form className=\"card glass\" style={{marginTop:12}} onSubmit={submitComment}>\n        <textarea className=\"textarea\" placeholder=\"Ваш комментарий…\" value={text} onChange={e=>setText(e.target.value)} required />\n        <button className=\"btn primary\" type=\"submit\">Отправить</button>\n      </form>\n    </div>\n  );\n};\nexport default CatchDetailPage;\n"],"names":["CatchDetailPage","id","useParams","data","setData","useState","err","setErr","text","setText","useEffect","catchById","submitComment","addCatchComment","d","ex","jsx","jsxs","Icon","config","c","i"],"mappings":"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"}