import{r,j as t,c as f}from"./index-Cex0JMuM.js";const N=()=>{const[c,d]=r.useState(null),[l,n]=r.useState(null),[u,o]=r.useState(!0);return r.useEffect(()=>{let e=!0;async function m(){o(!0),n(null);try{const s=localStorage.getItem("token")||"",a=await fetch(`${f.apiBase}/notifications`,{headers:{Accept:"application/json",...s?{Authorization:`Bearer ${s}`}:{}},credentials:"include"});if(!a.ok){const x=await a.text().catch(()=>"");throw new Error(`HTTP ${a.status}: ${x||a.statusText}`)}const i=await a.json(),h=Array.isArray(i)?i:Array.isArray(i.data)?i.data:[];if(!e)return;d(h)}catch(s){if(!e)return;n(s?.message?.includes("Failed to fetch")?"Не удалось загрузить. Проверьте сеть или CORS.":s?.message||"Ошибка загрузки уведомлений")}finally{e&&o(!1)}}return m(),()=>{e=!1}},[]),u?t.jsx("div",{className:"container",children:"Загрузка уведомлений…"}):l?t.jsx("div",{className:"container",children:t.jsxs("div",{className:"card error",children:[t.jsx("div",{className:"card-title",children:"Ошибка"}),t.jsx("div",{className:"card-text",children:l})]})}):!c||c.length===0?t.jsx("div",{className:"container",children:"Пока уведомлений нет."}):t.jsxs("div",{className:"container",children:[t.jsx("h1",{className:"page-title",children:"Уведомления"}),t.jsx("ul",{className:"list",children:c.map(e=>t.jsxs("li",{className:"list-item",children:[t.jsx("div",{className:"list-title",children:e.title||e.type}),e.message&&t.jsx("div",{className:"list-subtitle",children:e.message}),t.jsxs("div",{className:"list-meta",children:[e.created_at?new Date(e.created_at).toLocaleString():"",e.read_at?" • прочитано":""]})]},e.id))})]})};export{N as default};
//# sourceMappingURL=NotificationsPage-CiOMc3Ar.js.map
