import{c as u}from"./index-Cex0JMuM.js";const l=u?.api?.v1Base??u?.apiBase??u?.api?.base??"/api/v1";function d(t){return t.startsWith("/")||(t="/"+t),l.endsWith("/")?l.replace(/\/+$/,"")+t:l+t}async function a(t,e={}){const r=d(t),c={Accept:"application/json"},o=localStorage.getItem("token");e.auth&&o&&(c.Authorization=`Bearer ${o}`);let n=e.body;!e.formData&&n&&typeof n=="object"&&(c["Content-Type"]="application/json",n=JSON.stringify(n));const i=await fetch(r,{method:e.method||"GET",credentials:"include",headers:c,body:n,cache:"no-store"});if(!i.ok){let f=null;try{f=await i.json()}catch{}const h=f?.message||`HTTP ${i.status}`;throw new Error(h)}if(i.status===204)return null;const s=await i.text();if(!s)return null;try{return JSON.parse(s)}catch{return s}}async function m(t={}){const e=new URLSearchParams;t.limit!=null&&e.set("limit",String(t.limit)),t.offset!=null&&e.set("offset",String(t.offset));const r=`/feed${e.toString()?`?${e.toString()}`:""}`;return a(r,{auth:!0})}async function p(t){return a(`/catch/${t}`,{auth:!0})}async function S(t){return a(`/catch/${t}/like`,{method:"POST",auth:!0})}async function g(t,e){return a(`/catch/${t}/rate`,{method:"POST",auth:!0,body:{value:e}})}async function $(t,e={}){return a("/bonus/award",{method:"POST",auth:!0,body:{action:t,...e}})}async function w(t={}){const e=new URLSearchParams;t.limit!=null&&e.set("limit",String(t.limit)),t.filter&&e.set("filter",t.filter),t.bbox&&e.set("bbox",t.bbox.join(","));const r=`/map/points${e.toString()?`?${e.toString()}`:""}`;return a(r,{auth:!0})}async function b(t){return a("/points",{method:"POST",auth:!0,body:t})}async function T(t){return a(`/points/${t}`,{auth:!0})}async function k(t){return a("/catch",{method:"POST",auth:!0,body:t})}async function j(t){return a("/weather/favs",{method:"POST",auth:!0,body:t})}async function C(){return a("/profile/me",{auth:!0})}function O(){try{return!!localStorage.getItem("token")}catch{return!1}}async function P(){const t=typeof localStorage<"u"?localStorage.getItem("token"):null;try{await fetch(`${base}/auth/logout`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},credentials:"include"})}catch{}try{typeof localStorage<"u"&&localStorage.removeItem("token")}catch{}return{ok:!0}}async function A(t,e){const r=`${base}/catch/${t}/comments`,c=typeof localStorage<"u"?localStorage.getItem("token"):null,o=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...c?{Authorization:`Bearer ${c}`}:{}},credentials:"include",body:JSON.stringify({text:e})});if(o.status===422){const n=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...c?{Authorization:`Bearer ${c}`}:{}},credentials:"include",body:JSON.stringify({message:e})});if(!n.ok){const i=await n.text().catch(()=>"");throw new Error(`addCatchComment failed: ${n.status} ${n.statusText} ${i}`)}try{return await n.json()}catch{return{ok:!0}}}if(!o.ok){const n=await o.text().catch(()=>"");throw new Error(`addCatchComment failed: ${o.status} ${o.statusText} ${n}`)}try{return await o.json()}catch{return{ok:!0}}}export{k as a,$ as b,b as c,C as d,P as e,m as f,p as g,A as h,O as i,T as j,S as l,w as p,g as r,j as s};
//# sourceMappingURL=api-DpD81C9e.js.map
